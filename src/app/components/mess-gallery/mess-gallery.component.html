<div class="mess-gallery-container" (keydown)="onKeydown($event)" tabindex="0">
  <!-- Header Section -->
  <div class="gallery-header">
    <h1 class="gallery-title">Mess Gallery</h1>
    <p class="gallery-subtitle">Explore our dining facilities and delicious meal options</p>
  </div>

  <!-- Filter Buttons -->
  <div class="filter-buttons">
    <button 
      class="filter-btn" 
      [class.active]="activeFilter === 'all'"
      (click)="filterImages('all')">
      All ({{ getImageCount('all') }})
    </button>
    <button 
      class="filter-btn" 
      [class.active]="activeFilter === 'breakfast'"
      (click)="filterImages('breakfast')">
      Breakfast ({{ getImageCount('breakfast') }})
    </button>
    <button 
      class="filter-btn" 
      [class.active]="activeFilter === 'lunch'"
      (click)="filterImages('lunch')">
      Lunch ({{ getImageCount('lunch') }})
    </button>
    <button 
      class="filter-btn" 
      [class.active]="activeFilter === 'dinner'"
      (click)="filterImages('dinner')">
      Dinner ({{ getImageCount('dinner') }})
    </button>
    <button 
      class="filter-btn" 
      [class.active]="activeFilter === 'hall'"
      (click)="filterImages('hall')">
      Dining Hall ({{ getImageCount('hall') }})
    </button>
    <button 
      class="filter-btn" 
      [class.active]="activeFilter === 'kitchen'"
      (click)="filterImages('kitchen')">
      Kitchen ({{ getImageCount('kitchen') }})
    </button>
  </div>

  <!-- Loading Spinner -->
  <div class="loading-container" *ngIf="isLoading">
    <div class="loading-spinner"></div>
    <p class="loading-text">Loading gallery images...</p>
  </div>

  <!-- Image Grid -->
  <div class="image-grid" *ngIf="!isLoading">
    <div 
      class="image-card" 
      *ngFor="let image of filteredImages; trackBy: trackByImageId"
      (click)="openLightbox(image)">
      <div class="image-wrapper">
        <img 
          [src]="image.src" 
          [alt]="image.title"
          loading="lazy"
          class="gallery-image"
          (load)="onImageLoad(image.id)"
          (error)="onImageError(image.id)"
          [class.error]="isImageError(image.id)">
        <div class="image-overlay" *ngIf="!isImageError(image.id)">
          <h3 class="image-title">{{ image.title }}</h3>
          <p class="image-description">{{ image.description }}</p>
        </div>
        <div class="error-overlay" *ngIf="isImageError(image.id)">
          <div class="error-icon">ðŸ“·</div>
          <p class="error-text">Image unavailable</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="filteredImages.length === 0">
    <div class="empty-icon">
      <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" fill="currentColor" viewBox="0 0 16 16">
        <path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>
        <path d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1h12z"/>
      </svg>
    </div>
    <h3>No images found</h3>
    <p>Try selecting a different category</p>
  </div>

  <!-- Lightbox Modal -->
  <div class="lightbox-overlay" *ngIf="selectedImage" (click)="closeLightbox()">
    <div class="lightbox-container" (click)="$event.stopPropagation()">
      <!-- Close Button -->
      <button class="lightbox-close" (click)="closeLightbox()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
          <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>
        </svg>
      </button>

      <!-- Navigation Buttons -->
      <button class="lightbox-nav lightbox-prev" (click)="previousImage()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/>
        </svg>
      </button>

      <button class="lightbox-nav lightbox-next" (click)="nextImage()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
        </svg>
      </button>

      <!-- Image Content -->
      <div class="lightbox-content">
        <img 
          [src]="selectedImage.src" 
          [alt]="selectedImage.title"
          class="lightbox-image">
        
        <div class="lightbox-info">
          <h2 class="lightbox-title">{{ selectedImage.title }}</h2>
          <p class="lightbox-description">{{ selectedImage.description }}</p>
          <span class="lightbox-category">{{ selectedImage.category | titlecase }}</span>
        </div>
      </div>
    </div>
  </div>
</div>
